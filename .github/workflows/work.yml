
# 工作流名称
name: auto build

# 触发事件
on:
  push:
    branches: [ main ]

env:
  APP_NAME: myapp

jobs:
  # 多个作业是并行运行的
  build-and-deploy:
    name: 编译go程序
    # 需要设定为 私有运行器
    runs-on: self-hosted

    steps:
      - name: Checkout 检出代码
        uses: actions/checkout@main

      # - name: Set up Go env
      #   uses: actions/setup-go@v5
      #   with:
      #     go-version: '1.21'

      # - name: 编译程序
      #   run: |
      #     export PATH=/opt/go/bin:$PATH
      #     export GOPROXY='https://goproxy.cn,direct'
      #     /opt/go/bin/go version
      #     go version
      #     cd cmd && go build -o app

    - name: Set up Go
      uses: actions/setup-go@v5
      with:
        go-version: '1.21'

    - name: Build
      run: cd cmd && go build -o app
